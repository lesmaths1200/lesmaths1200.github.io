<!DOCTYPE html>

<html lang="fr">
<!--
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë Chatbot Math√©matiques Coll√®ge                                     ‚ïë
‚ïë ¬© 2026 Laurent Billard - Tous droits r√©serv√©s                     ‚ïë
‚ïë Version: 1.0.0 | Date: 2026-01-17                                 ‚ïë
‚ïë Fingerprint: MTH-CHATBOT-FR-2026-v1                               ‚ïë
‚ïë                                                                   ‚ïë
‚ïë PROPRI√âT√â INTELLECTUELLE PROT√âG√âE                                 ‚ïë
‚ïë Utilisation non autoris√©e strictement interdite                   ‚ïë
‚ïë Contact: votre@email.com                                          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Laurent Billard">
    <meta name="copyright" content="¬© 2026 Laurent Billard">
    <meta name="description" content="Chatbot √©ducatif pour math√©matiques niveau coll√®ge - Contenu prot√©g√©">
    <title>Assistant Math√©matiques Coll√®ge</title>

```
<!-- React -->
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- KaTeX pour le rendu LaTeX -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
    }
    .katex { font-size: 1.1em; }
    .katex-display { margin: 0.5em 0; }
</style>
```

</head>
<body>
    <div id="root"></div>

```
<script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // Ic√¥nes SVG
    const SendIcon = () => (
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>
    );

    const CalculatorIcon = ({ size = 20 }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <rect x="4" y="2" width="16" height="20" rx="2"></rect>
            <line x1="8" y1="6" x2="16" y2="6"></line>
            <line x1="16" y1="14" x2="16" y2="18"></line>
            <line x1="8" y1="14" x2="8" y2="18"></line>
            <line x1="12" y1="14" x2="12" y2="18"></line>
            <line x1="8" y1="10" x2="16" y2="10"></line>
        </svg>
    );

    const BookIcon = ({ size = 16 }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
        </svg>
    );

    const LightbulbIcon = ({ size = 16 }) => (
        <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <path d="M9 18h6"></path>
            <path d="M10 22h4"></path>
            <path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path>
        </svg>
    );

    // Composant pour afficher du texte avec LaTeX
    const MathText = ({ text }) => {
        const textRef = useRef(null);

        useEffect(() => {
            if (textRef.current && window.renderMathInElement) {
                renderMathInElement(textRef.current, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false}
                    ],
                    throwOnError: false
                });
            }
        }, [text]);

        return <div ref={textRef} className="whitespace-pre-line">{text}</div>;
    };

    const MathChatbot = () => {
        const [messages, setMessages] = useState([
            {
                type: 'bot',
                text: "Bonjour ! Je suis ton assistant en math√©matiques. Tape 'menu' pour voir les th√®mes disponibles !"
            }
        ]);
        const [input, setInput] = useState('');
        const [lastExercise, setLastExercise] = useState(null);
        const [mathData, setMathData] = useState(null);
        const [loading, setLoading] = useState(true);
        const [error, setError] = useState(null);
        const messagesEndRef = useRef(null);

        const scrollToBottom = () => {
            messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
        };

        useEffect(() => {
            scrollToBottom();
        }, [messages]);

        // Chargement des donn√©es depuis mathData.json
        useEffect(() => {
            fetch('mathData.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Fichier mathData.json introuvable. Assurez-vous qu\'il est dans le m√™me dossier que index.html');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('‚úÖ Donn√©es charg√©es avec succ√®s:', data);
                    setMathData(data);
                    setLoading(false);
                })
                .catch(error => {
                    console.error('‚ùå Erreur chargement:', error);
                    setError(error.message);
                    setLoading(false);
                });
        }, []);

        const generateExercise = (themeKey) => {
            if (!mathData || !mathData.themes[themeKey]) return null;
            const exercices = mathData.themes[themeKey].exercices;
            if (!exercices || exercices.length === 0) return null;
            const ex = exercices[Math.floor(Math.random() * exercices.length)];
            return { q: ex.question, a: ex.reponse };
        };

        const analyzeMessage = (msg) => {
            if (!mathData) return { type: 'default', response: "Chargement..." };

            const lowerMsg = msg.toLowerCase();

            // Menu
            if (lowerMsg.includes('menu') || lowerMsg.includes('aide') || lowerMsg.includes('th√®mes') || lowerMsg.includes('themes')) {
                const themesList = Object.entries(mathData.themes)
                    .map(([key, theme], idx) => `${idx + 1}Ô∏è‚É£ ${theme.nom}`)
                    .join('\n');
                return {
                    type: 'menu',
                    response: `üìö Th√®mes disponibles :\n\n${themesList}\n\nüí° Tape le nom d'un th√®me pour des explications\nüìù Tape 'exercice [th√®me]' pour t'entra√Æner`
                };
            }

            // Exercice
            if (lowerMsg.includes('exercice') || lowerMsg.includes('pratique')) {
                for (let [themeKey, themeData] of Object.entries(mathData.themes)) {
                    if (themeData.keywords.some(kw => lowerMsg.includes(kw))) {
                        const ex = generateExercise(themeKey);
                        if (ex) {
                            setLastExercise(ex);
                            return {
                                type: 'exercise',
                                response: `üìù Exercice :\n\n${ex.q}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüí° Tape 'solution' pour voir la correction !`
                            };
                        }
                    }
                }
                const themesNoms = Object.values(mathData.themes).map(t => `‚Ä¢ ${t.nom}`).join('\n');
                return {
                    type: 'exercise',
                    response: `üìù Sur quel th√®me veux-tu t'exercer ?\n\n${themesNoms}`
                };
            }

            // Solution
            if (lowerMsg.includes('solution') || lowerMsg.includes('r√©ponse') || lowerMsg.includes('reponse') || lowerMsg.includes('correction')) {
                if (lastExercise) {
                    return {
                        type: 'solution',
                        response: `‚úÖ ${lastExercise.a}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüí™ Veux-tu un autre exercice ?`
                    };
                }
                return {
                    type: 'solution',
                    response: "Demande d'abord un exercice !\nTape : 'exercice [th√®me]'"
                };
            }

            // Recherche th√®me
            for (let [themeKey, themeData] of Object.entries(mathData.themes)) {
                if (themeData.keywords.some(kw => lowerMsg.includes(kw))) {
                    for (let [subKey, explanation] of Object.entries(themeData.explanations)) {
                        if (lowerMsg.includes(subKey.toLowerCase())) {
                            return {
                                type: 'explanation',
                                response: `üí° ${explanation}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìù Veux-tu t'entra√Æner ? Tape 'exercice' !`
                            };
                        }
                    }
                    const allExplanations = Object.values(themeData.explanations).join('\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n');
                    return {
                        type: 'explanation',
                        response: `üìñ ${themeData.nom} :\n\n${allExplanations}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìù Tape 'exercice' pour pratiquer !`
                    };
                }
            }

            // Salutations
            if (lowerMsg.match(/^(bonjour|salut|hello|coucou|hey|bonsoir)/)) {
                return {
                    type: 'greeting',
                    response: "Bonjour ! üòä Comment puis-je t'aider en math√©matiques ?\n\nüí° Tape 'menu' pour voir les th√®mes !"
                };
            }

            if (lowerMsg.match(/merci|thanks/)) {
                return {
                    type: 'thanks',
                    response: "De rien ! Bon courage pour tes r√©visions ! üí™üòä"
                };
            }

            if (lowerMsg.match(/au revoir|bye|√† bient√¥t/)) {
                return {
                    type: 'goodbye',
                    response: "√Ä bient√¥t ! Continue √† bien travailler ! üëãüòä"
                };
            }

            return {
                type: 'default',
                response: "Je n'ai pas compris. ü§î\n\nüí° Tape 'menu' pour voir les th√®mes\n\n‚ú® Exemples :\n‚Ä¢ Explique les fractions\n‚Ä¢ Exercice sur les pourcentages\n‚Ä¢ Pythagore"
            };
        };

        const handleSend = () => {
            if (!input.trim()) return;

            const userMessage = { type: 'user', text: input };
            setMessages(prev => [...prev, userMessage]);

            const response = analyzeMessage(input);

            setTimeout(() => {
                const botMessage = { type: 'bot', text: response.response };
                setMessages(prev => [...prev, botMessage]);
            }, 500);

            setInput('');
        };

        const handleKeyPress = (e) => {
            if (e.key === 'Enter') {
                handleSend();
            }
        };

        // √âcran de chargement
        if (loading) {
            return (
                <div className="flex items-center justify-center h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                    <div className="text-center">
                        <CalculatorIcon size={48} />
                        <p className="mt-4 text-gray-600">Chargement des donn√©es...</p>
                        <p className="mt-2 text-sm text-gray-400">Lecture de mathData.json</p>
                    </div>
                </div>
            );
        }

        // √âcran d'erreur
        if (error) {
            return (
                <div className="flex items-center justify-center h-screen bg-gradient-to-br from-red-50 to-orange-100 p-4">
                    <div className="max-w-md bg-white p-8 rounded-lg shadow-lg">
                        <h2 className="text-2xl font-bold text-red-600 mb-4">‚ùå Erreur de chargement</h2>
                        <p className="text-gray-700 mb-4">{error}</p>
                        <div className="bg-gray-100 p-4 rounded text-sm">
                            <p className="font-semibold mb-2">üí° Solutions :</p>
                            <ol className="list-decimal list-inside space-y-2">
                                <li>V√©rifiez que <code className="bg-gray-200 px-1 rounded">mathData.json</code> est dans le m√™me dossier que <code className="bg-gray-200 px-1 rounded">index.html</code></li>
                                <li>Utilisez un serveur local :
                                    <ul className="list-disc list-inside ml-6 mt-1 text-xs">
                                        <li><code className="bg-gray-200 px-1 rounded">python -m http.server 8000</code></li>
                                        <li>Ou extension VS Code "Live Server"</li>
                                    </ul>
                                </li>
                                <li>Ouvrez la console (F12) pour plus de d√©tails</li>
                            </ol>
                        </div>
                        <button
                            onClick={() => window.location.reload()}
                            className="mt-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 w-full"
                        >
                            üîÑ R√©essayer
                        </button>
                    </div>
                </div>
            );
        }

        const quickButtons = mathData ? Object.entries(mathData.themes).slice(0, 4).map(([key, theme]) => ({
            icon: <BookIcon size={16} />,
            text: theme.nom,
            action: `explique-moi ${theme.nom.toLowerCase()}`
        })) : [];

        return (
            <div className="flex flex-col h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                <div className="bg-indigo-600 text-white p-4 shadow-lg">
                    <h1 className="text-2xl font-bold flex items-center gap-2">
                        <CalculatorIcon size={28} />
                        Assistant Math√©matiques Coll√®ge
                    </h1>
                    <p className="text-sm text-indigo-100 mt-1">
                        {mathData ? `${Object.keys(mathData.themes).length} th√®mes disponibles ‚Ä¢ Rendu LaTeX activ√©` : 'Chargement...'}
                    </p>
                </div>

                <div className="flex-1 overflow-y-auto p-4 space-y-4">
                    {messages.map((msg, idx) => (
                        <div key={idx} className={`flex ${msg.type === 'user' ? 'justify-end' : 'justify-start'}`}>
                            <div className={`max-w-md md:max-w-lg px-4 py-3 rounded-lg shadow ${
                                msg.type === 'user'
                                    ? 'bg-indigo-600 text-white'
                                    : 'bg-white text-gray-800'
                            }`}>
                                <MathText text={msg.text} />
                            </div>
                        </div>
                    ))}
                    <div ref={messagesEndRef} />
                </div>

                <div className="px-4 pb-2 flex gap-2 flex-wrap">
                    {quickButtons.map((btn, idx) => (
                        <button
                            key={idx}
                            onClick={() => setInput(btn.action)}
                            className="flex items-center gap-1 px-3 py-2 bg-white text-indigo-600 rounded-full text-sm shadow hover:shadow-md transition-shadow"
                        >
                            {btn.icon}
                            <span>{btn.text}</span>
                        </button>
                    ))}
                    <button
                        onClick={() => setInput("donne-moi un exercice")}
                        className="flex items-center gap-1 px-3 py-2 bg-white text-indigo-600 rounded-full text-sm shadow hover:shadow-md transition-shadow"
                    >
                        <LightbulbIcon size={16} />
                        <span>Exercice</span>
                    </button>
                </div>

                <div className="p-4 bg-white border-t border-gray-200">
                    <div className="flex gap-2 max-w-4xl mx-auto">
                        <input
                            type="text"
                            value={input}
                            onChange={(e) => setInput(e.target.value)}
                            onKeyPress={handleKeyPress}
                            placeholder="Pose ta question..."
                            className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                        />
                        <button
                            onClick={handleSend}
                            className="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-2"
                        >
                            <SendIcon />
                        </button>
                    </div>
                    <div className="text-center mt-3 text-xs text-gray-400">
                        ¬© 2026 Laurent Billard | Chatbot Math√©matiques v1.0 | Tous droits r√©serv√©s
                    </div>
                </div>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<MathChatbot />);
</script>
```

</body>
</html>